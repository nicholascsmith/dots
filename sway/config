# ==============================================================================
# SWAY CONFIGURATION
# ==============================================================================

include /etc/sway/config.d/*
include ~/.config/sway/settings

exec dbus-update-activation-environment --all

# THEME & GTK
# ==============================================================================
exec_always {
    gsettings set org.gnome.desktop.interface gtk-theme 'Adwaita-dark'
    gsettings set org.gnome.desktop.interface icon-theme 'Adwaita'
    gsettings set org.gnome.desktop.interface cursor-theme 'Adwaita'
    gsettings set org.gnome.desktop.interface font-name 'JetBrains Mono 11'
    gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
}

seat seat0 xcursor_theme Adwaita 32

# OUTPUTS
# ==============================================================================
output * bg ~/Pictures/wallpapers/bg.jpg fill
output eDP-1 resolution 1920x1080@60Hz adaptive_sync on allow_tearing yes

# Laptop lid
bindswitch --reload --locked lid:on output eDP-1 disable
bindswitch --reload --locked lid:off output eDP-1 enable

# IDLE & POWER
# ==============================================================================
exec swayidle -w \
    timeout 300 'brightnessctl -s && brightnessctl set 5%' resume 'brightnessctl -r' \
    timeout 900 'swaylock -f -i ~/Pictures/wallpapers/bg.jpg' \
    timeout 1200 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' \
    timeout 1800 'systemctl suspend' \
    before-sleep 'swaylock -f -i ~/Pictures/wallpapers/bg.jpg'

# INPUT
# ==============================================================================
input type:pointer {
    accel_profile "flat"
    pointer_accel 0.12
}

input type:touchpad {
    accel_profile adaptive
    drag enabled
    dwt enabled
    natural_scroll disabled
    tap enabled
}

input type:keyboard {
    xkb_layout "us"
    xkb_numlock enabled
}

focus_follows_mouse yes
floating_modifier $mod normal

# APPEARANCE
# ==============================================================================
smart_borders on
default_border pixel 2
default_floating_border pixel 2

# Window opacity
for_window [class=".*"] opacity 1
for_window [app_id=".*"] opacity 1
for_window [app_id="com.heroicgameslauncher.hgl"] opacity 1
for_window [app_id="mpv"] opacity 1

# Window colors (border, background, text, indicator, child_border)
client.focused          #ffffff #000000 #000000 #ffffff #ffffff
client.focused_inactive #000000 #000000 #000000 #000000 #000000
client.unfocused        #000000 #000000 #000000 #000000 #000000
client.urgent           #ffff00 #000000 #000000 #ffff00 #ffff00

# Status bar
bar {
    position top
    swaybar_command waybar
}

# WINDOW RULES
# ==============================================================================
for_window [app_id="^.*"] inhibit_idle fullscreen

for_window [window_type="dialog"] floating enable
for_window [window_role="dialog"] floating enable
for_window [app_id="org.pulseaudio.pavucontrol"] floating enable
for_window [app_id="galculator"] floating enable
for_window [instance="gufw.py"] floating enable
for_window [app_id="blueman-manager"] floating enable

# KEYBINDINGS
# ==============================================================================

# System
bindsym $mod+Escape reload
bindsym $mod+l exec swaylock -f -i ~/Pictures/wallpapers/bg.jpg

# Applications
bindsym $mod+e exec brave-browser --app=https://account.proton.me/apps
bindsym $mod+Shift+e exec brave-browser --app=https://mail.tutanota.com
bindsym $mod+space exec $term
bindsym $mod+t exec transmission-gtk
bindsym $mod+b exec $web
bindsym $mod+c exec zed
bindsym $mod+n exec protonvpn-app
bindsym $mod+Shift+n exec blueman-manager
bindsym $mod+v exec pavucontrol
bindsym $mod+f exec $file_browser
bindsym $mod+r exec flatpak run com.obsproject.Studio

# Web Apps
bindsym $mod+y exec brave-browser --app=https://www.youtube.com/feed/subscriptions
bindsym $mod+a exec xarchiver
bindsym $mod+slash exec brave-browser --app=https://claude.ai
bindsym $mod+Return exec flatpak run com.heroicgameslauncher.hgl
bindsym $mod+x exec brave-browser --app=https://x.com
bindsym $mod+m exec brave-browser --app=https://music.apple.com
bindsym $mod+i exec brave-browser --app=https://www.icloud.com/notes
bindsym $mod+Shift+i exec brave-browser --app=https://www.icloud.com/iclouddrive
bindsym $mod+g exec brave-browser --app=https://codeberg.org/ncarters?tab=repositories
bindsym $mod+Shift+g exec brave-browser --app=https://github.com/nicholascsmith?tab=repositories
bindsym $mod+w exec brave-browser --app=https://dash.cloudflare.com/

# Utilities
bindsym $mod+d exec gnome-disks
bindsym $mod+p exec system-config-printer
bindsym $mod+q kill

# Window Management
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
bindsym $mod+Shift+space floating toggle; [app_id="foot" floating] resize set 900 px 450 px; [app_id="zed" floating] resize set 1200 px 600 px

# Workspaces
bindsym $mod+Tab exec swaymsg workspace number $(( $(swaymsg -t get_workspaces | jq -r '.[] | select(.focused==true).num') % 5 + 1 ))
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5

# Media Keys
bindsym --locked XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym --locked XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym --locked XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym --locked XF86MonBrightnessDown exec brightnessctl -n set 5%-
bindsym --locked XF86MonBrightnessUp exec brightnessctl set +5%
bindsym Print exec grim -g "$(slurp)" ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png

# AUTOSTART
# ==============================================================================
exec {
    pidof /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 || /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
    pidof nm-applet || nm-applet
    pidof mako || mako
}

# Start ProtonVPN on workspace 1
exec swaymsg "workspace 1; exec protonvpn-app"
